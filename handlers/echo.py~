import random
from aiogram import types, Dispatcher
from config import bot

# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–≥—Ä
GAMES = ['‚öΩ', 'üé∞', 'üèÄ', 'üéØ', 'üé≥', 'üé≤']


async def echo_handler(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    if 'game' in message.text.lower():  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–ª–æ–≤–æ 'game' –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
        random_game = random.choice(GAMES)  # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∏–≥—Ä—É
        await bot.send_dice(chat_id=message.chat.id, emoji=random_game)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–≥—Ä—É
    elif message.text.isdigit():  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ü–µ–ª—ã–º —á–∏—Å–ª–æ–º
        number = int(message.text)
        await message.answer(f"{number}^2 = {number ** 2}")  # –í–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç
    else:
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–∏—Å–ª–æ–º —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
            number = float(message.text)
            await message.answer(f"{number}^2 = {number ** 2}")  # –í–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç
        except ValueError:
            # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ–º, –ø–æ–≤—Ç–æ—Ä—è–µ–º –µ–≥–æ
            await message.answer(message.text)


def register_echo_handlers(dp: Dispatcher):
    """–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ echo"""
    dp.register_message_handler(echo_handler)
